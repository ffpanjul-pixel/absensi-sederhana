<html lang="id"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplikasi Absensi Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>body { margin: 0; }</style><style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            padding: 10px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        header {
            background-color: rgba(255, 255, 255, 0.95);
            color: #2c3e50;
            padding: 1.2rem;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .login-section, .admin-section, .employee-section, .public-section {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: none;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input:focus, select:focus {
            border-color: #3498db;
            outline: none;
        }
        
        button {
            background: linear-gradient(to right, #3498db, #2c3e50);
            color: white;
            border: none;
            padding: 14px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            width: 100%;
            margin-bottom: 15px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 14px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        table, th, td {
            border: 1px solid #e1e8ed;
        }
        
        th, td {
            padding: 10px;
            text-align: left;
        }
        
        th {
            background-color: #f8f9fa;
            color: #2c3e50;
            font-weight: 600;
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .btn-edit { background: linear-gradient(to right, #f39c12, #e67e22); }
        .btn-delete { background: linear-gradient(to right, #e74c3c, #c0392b); }
        .btn-logout { background: linear-gradient(to right, #95a5a6, #7f8c8d); }
        .btn-export { background: linear-gradient(to right, #27ae60, #219653); }
        .btn-public { background: linear-gradient(to right, #9b59b6, #8e44ad); }
        .btn-publish { background: linear-gradient(to right, #e67e22, #d35400); }
        
        .btn-logout, .btn-export, .btn-public, .btn-publish {
            width: auto;
            float: right;
            padding: 10px 15px;
            margin-left: 10px;
        }
        
        .notification {
            padding: 12px 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            display: none;
            font-weight: 500;
        }
        
        .success { background-color: #d4edda; color: #155724; border-left: 4px solid #28a745; }
        .error { background-color: #f8d7da; color: #721c24; border-left: 4px solid #dc3545; }
        .warning { background-color: #fff3cd; color: #856404; border-left: 4px solid #ffc107; }
        .info { background-color: #d1ecf1; color: #0c5460; border-left: 4px solid #17a2b8; }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            overflow-x: auto;
            background: #f8f9fa;
            border-radius: 8px;
            padding: 5px;
        }
        
        .tab {
            padding: 12px 20px;
            background-color: #e9ecef;
            cursor: pointer;
            border-radius: 6px;
            margin-right: 5px;
            white-space: nowrap;
            font-weight: 500;
            transition: all 0.3s;
            flex: 1;
            text-align: center;
        }
        
        .tab.active {
            background: linear-gradient(to right, #3498db, #2c3e50);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .keterangan {
            font-size: 14px;
            color: #6c757d;
            margin-top: 5px;
            line-height: 1.5;
        }
        
        .admin-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .admin-controls button {
            width: auto;
            flex: 1;
            min-width: 140px;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: #3498db;
        }
        
        .info-box {
            background: #e8f4fc;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            border-left: 4px solid #3498db;
        }
        
        .share-link {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
        }
        
        .share-link input {
            width: 100%;
            padding: 10px;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            margin-bottom: 10px;
            text-align: center;
            font-weight: 500;
        }
        
        .qr-code {
            text-align: center;
            margin: 20px 0;
        }
        
        .qr-code canvas {
            max-width: 200px;
            border: 5px solid white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .mobile-instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .stats-box {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .public-display {
            text-align: center;
            padding: 20px;
        }
        
        .public-title {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        
        .today-attendance {
            font-size: 1.2rem;
            color: #27ae60;
            margin-bottom: 30px;
        }
        
        .attendance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .attendance-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border-left: 4px solid #3498db;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .attendance-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .attendance-time {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .access-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .access-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(52, 152, 219, 0); }
            100% { box-shadow: 0 0 0 0 rgba(52, 152, 219, 0); }
        }
        
        .attendance-btn {
            background: linear-gradient(to right, #27ae60, #2ecc71);
            font-size: 18px;
            padding: 16px;
        }
        
        @media (max-width: 768px) {
            .access-options, .attendance-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .online-status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #27ae60;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 1000;
        }
        
        .offline-status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            z-index: 1000;
        }

        .login-options {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .login-option-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .login-option-btn.active {
            background: #3498db;
            color: white;
        }

        .attendance-status {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .status-item {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 15px;
            border-radius: 8px;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .status-present {
            border-left: 4px solid #27ae60;
        }
        
        .status-absent {
            border-left: 4px solid #e74c3c;
        }
        
        .status-count {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .status-label {
            font-size: 0.9rem;
            color: #6c757d;
        }

        .publish-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .url-display {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border: 2px dashed #3498db;
        }
        
        .publish-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .step-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .step-number {
            background: #3498db;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div id="online-status" class="online-status">
        <i class="fas fa-wifi"></i> ONLINE
    </div>
    
    <div class="container">
        <header>
            <h1><i class="fas fa-clipboard-check"></i> Aplikasi Absensi Online</h1>
            <p>Sistem pencatatan kehadiran peserta - Siap Publish</p>
        </header>
        
        <!-- Login Section -->
        <section id="login-section" class="login-section" style="display: none;">
            <div class="form-container">
                <h2><i class="fas fa-sign-in-alt"></i> Login</h2>
                <div class="keterangan">Pilih tipe login dan masukkan credential</div>
                
                <div class="notification" id="login-notification"></div>

                <div class="login-options">
                    <button class="login-option-btn active" id="admin-login-btn">
                        <i class="fas fa-user-shield"></i> Admin
                    </button>
                    <button class="login-option-btn" id="participant-login-btn">
                        <i class="fas fa-user"></i> Peserta
                    </button>
                </div>

                <!-- Admin Login Form -->
                <div id="admin-login-form">
                    <div class="form-group">
                        <label for="admin-username"><i class="fas fa-user"></i> Username Admin:</label>
                        <input type="text" id="admin-username" placeholder="Masukkan username admin" value="admin">
                    </div>
                    <div class="form-group">
                        <label for="admin-password"><i class="fas fa-lock"></i> Password Admin:</label>
                        <input type="password" id="admin-password" placeholder="Masukkan password admin" value="admin123">
                    </div>
                </div>

                <!-- Participant Login Form -->
                <div id="participant-login-form" style="display: none;">
                    <div class="form-group">
                        <label for="participant-name"><i class="fas fa-user"></i> Pilih Nama Peserta:</label>
                        <select id="participant-name"><option value="">-- Pilih Nama --</option><option value="DEDI PAMUNGKAS">DEDI PAMUNGKAS</option><option value="BUDI PURNOMO">BUDI PURNOMO</option><option value="SULARSO">SULARSO</option><option value="DHIKI HERMANTO">DHIKI HERMANTO</option><option value="MUHAMMAD RICKY SAPUTRA">MUHAMMAD RICKY SAPUTRA</option><option value="INDRA PERMANA">INDRA PERMANA</option><option value="MUHAMMAD NADIR">MUHAMMAD NADIR</option><option value="DJALIKA RAJAB">DJALIKA RAJAB</option><option value="MOCHAMAD FAISAL AKBAR">MOCHAMAD FAISAL AKBAR</option><option value="TAJI PANJI PAMUNGKAS">TAJI PANJI PAMUNGKAS</option><option value="ADAM ALFIANA">ADAM ALFIANA</option><option value="ADE RIDWAN">ADE RIDWAN</option><option value="AGUNG MUJAYANI SYAH POETRA">AGUNG MUJAYANI SYAH POETRA</option><option value="AHMAD HANAFI">AHMAD HANAFI</option><option value="AKHMAD KHADAFI">AKHMAD KHADAFI</option><option value="AHMAD RONI ALHABSI">AHMAD RONI ALHABSI</option><option value="ALFIYANIH">ALFIYANIH</option><option value="ANDREAS SETIAWAN">ANDREAS SETIAWAN</option><option value="DIAN SUNATRI">DIAN SUNATRI</option><option value="DIKA SAPUTRA">DIKA SAPUTRA</option><option value="DIMAS RAMADHANI SHAESARO PUTRA">DIMAS RAMADHANI SHAESARO PUTRA</option><option value="DIMAS RUSDI ANGGARA">DIMAS RUSDI ANGGARA</option><option value="DUDI IRAWAN">DUDI IRAWAN</option><option value="DWI PUTRA RIZKY">DWI PUTRA RIZKY</option><option value="FIZA FIKRI QURAISH SURYA">FIZA FIKRI QURAISH SURYA</option><option value="GHANI AHMAD MASUNI">GHANI AHMAD MASUNI</option><option value="INDRA MAULANA">INDRA MAULANA</option><option value="LAUREL KIFLE HELEN">LAUREL KIFLE HELEN</option><option value="LUSITA ANGRAINI">LUSITA ANGRAINI</option><option value="LUTFI AHMAD ABIMANYU">LUTFI AHMAD ABIMANYU</option><option value="MOHAMMAD DAFFATHUR RAHMAN">MOHAMMAD DAFFATHUR RAHMAN</option><option value="MUHAMMAD FEBRIANSYAH">MUHAMMAD FEBRIANSYAH</option><option value="NICO RONALDO">NICO RONALDO</option><option value="NUR MAARIF">NUR MAARIF</option><option value="NURSALIM">NURSALIM</option><option value="PANJI TEGUH SUBANGUN">PANJI TEGUH SUBANGUN</option><option value="RAYHAN AKBARUDIN JUNIOR">RAYHAN AKBARUDIN JUNIOR</option><option value="RIYANTO">RIYANTO</option><option value="SAHID HAIDIR">SAHID HAIDIR</option><option value="SUKMA PRAYOGA">SUKMA PRAYOGA</option><option value="M ILHAM SAPUTRA">M ILHAM SAPUTRA</option><option value="NIKI ALAMSYAH">NIKI ALAMSYAH</option><option value="SUGIYANTO">SUGIYANTO</option><option value="IQBAL KHOIRUDIN">IQBAL KHOIRUDIN</option><option value="PUTRI AYU LESTARI">PUTRI AYU LESTARI</option><option value="ANDIKA PRATAMA NUGROHO">ANDIKA PRATAMA NUGROHO</option><option value="RAFLI">RAFLI</option><option value="FAJAR NUR FIRDAUS">FAJAR NUR FIRDAUS</option></select>
                    </div>
                    <div class="form-group">
                        <label for="participant-password"><i class="fas fa-lock"></i> Password Peserta:</label>
                        <input type="password" id="participant-password" placeholder="Masukkan password peserta" value="peserta123">
                    </div>
                </div>

                <button id="login-btn"><i class="fas fa-sign-in-alt"></i> Login</button>
                
                <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> Informasi Login:</h4>
                    <div id="admin-login-info">
                        <p><strong>Admin:</strong></p>
                        <ul>
                            <li>Username: <strong>admin</strong></li>
                            <li>Password: <strong>admin123</strong></li>
                        </ul>
                    </div>
                    <div id="participant-login-info" style="display: none;">
                        <p><strong>Peserta:</strong></p>
                        <ul>
                            <li>Pilih nama dari dropdown</li>
                            <li>Password: <strong>peserta123</strong></li>
                        </ul>
                    </div>
                </div>
                
                <div class="access-options">
                    <div class="access-card">
                        <h3><i class="fas fa-qrcode"></i> Akses Cepat</h3>
                        <p>Scan QR Code untuk langsung ke halaman absensi</p>
                        <div class="qr-code">
                            <canvas id="login-qr-code" width="200" height="200"></canvas>
                        </div>
                    </div>
                    
                    <div class="access-card">
                        <h3><i class="fas fa-eye"></i> Lihat Absensi</h3>
                        <p>Lihat daftar peserta yang sudah absen hari ini</p>
                        <button onclick="showPublicSection()" class="btn-public">
                            <i class="fas fa-users"></i> Tampilkan Absensi
                        </button>
                    </div>
                </div>
                
                <div class="mobile-instructions">
                    <h4><i class="fas fa-mobile-alt"></i> Aplikasi Siap Publish:</h4>
                    <p>Aplikasi ini sudah siap dipublish ke hosting manapun. Data tersimpan di browser pengguna dan bisa diakses dari mana saja.</p>
                    <button onclick="showPublishInstructions()" class="btn-publish" style="width: 100%; margin-top: 10px;">
                        <i class="fas fa-cloud-upload-alt"></i> Cara Publish Aplikasi
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Employee Section -->
        <section id="employee-section" class="employee-section" style="display: none;">
            <button id="employee-logout" class="btn-logout"><i class="fas fa-sign-out-alt"></i> Logout</button>
            
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-user-clock"></i> Absensi Peserta
                </div>
                <div class="keterangan">Silakan klik tombol absen untuk mencatat kehadiran Anda</div>
                <div class="notification" id="employee-notification"></div>
                
                <div class="form-group">
                    <label>Nama Peserta:</label>
                    <input type="text" id="employee-name-display" readonly="" style="background: #f8f9fa; font-weight: bold; font-size: 16px;">
                </div>
                
                <button id="attendance-btn" class="attendance-btn pulse"><i class="fas fa-fingerprint"></i> Absen Masuk</button>
                
                <div class="info-box">
                    <h4><i class="fas fa-clock"></i> Info Absensi:</h4>
                    <p>Waktu absensi akan tercatat secara otomatis. Anda hanya dapat absen sekali per hari.</p>
                </div>
            </div>
            
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-history"></i> Riwayat Absensi Anda
                </div>
                <div class="keterangan">Riwayat absensi Anda akan ditampilkan di bawah</div>
                <table id="employee-attendance-table">
                    <thead>
                        <tr>
                            <th>Tanggal</th>
                            <th>Nama Peserta</th>
                            <th>Jam Masuk</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="employee-attendance-body">
                    </tbody>
                </table>
            </div>
        </section>
        
        <!-- Admin Section -->
        <section id="admin-section" class="admin-section" style="display: none;">
            <button id="admin-logout" class="btn-logout"><i class="fas fa-sign-out-alt"></i> Logout</button>
            
            <div class="card">
                <div class="card-title">
                    <i class="fas fa-tachometer-alt"></i> Panel Admin
                </div>
                <div class="keterangan">Kelola data peserta dan monitoring absensi real-time</div>
                <div class="notification" id="admin-notification"></div>
                
                <div class="stats-box">
                    <div class="stat-card">
                        <div class="stat-number" id="total-attendance">0</div>
                        <div class="stat-label">Total Absensi</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="today-attendance">0</div>
                        <div class="stat-label">Absensi Hari Ini</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="total-participants">0</div>
                        <div class="stat-label">Total Peserta</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="attendance-percentage">0%</div>
                        <div class="stat-label">Persentase Hadir</div>
                    </div>
                </div>

                <div class="attendance-status">
                    <div class="status-item status-present">
                        <div class="status-count" id="present-count">0</div>
                        <div class="status-label">Sudah Absen</div>
                    </div>
                    <div class="status-item status-absent">
                        <div class="status-count" id="absent-count">0</div>
                        <div class="status-label">Belum Absen</div>
                    </div>
                </div>
                
                <div class="admin-controls">
                    <button id="export-excel-btn" class="btn-export"><i class="fas fa-file-excel"></i> Export ke Excel</button>
                    <button id="refresh-data-btn" class="btn-export"><i class="fas fa-sync-alt"></i> Refresh Data</button>
                    <button onclick="showPublicSection()" class="btn-public"><i class="fas fa-tv"></i> Tampilan Publik</button>
                    <button onclick="showPublishInstructions()" class="btn-publish"><i class="fas fa-share"></i> Publish</button>
                </div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="attendance"><i class="fas fa-list-alt"></i> Data Absensi</div>
                <div class="tab" data-tab="employee"><i class="fas fa-users"></i> Kelola Peserta</div>
                <div class="tab" data-tab="monitoring"><i class="fas fa-chart-bar"></i> Monitoring</div>
                <div class="tab" data-tab="qrcode"><i class="fas fa-qrcode"></i> QR Code</div>
            </div>
            
            <!-- Tab Data Absensi -->
            <div class="tab-content active" id="attendance-tab">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-clipboard-list"></i> Rekap Absensi Harian
                    </div>
                    <div class="keterangan">Data absensi semua peserta dari semua perangkat.</div>
                    <table id="admin-attendance-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Tanggal</th>
                                <th>Nama Peserta</th>
                                <th>Jam Masuk</th>
                                <th>Status</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="admin-attendance-body">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Tab Kelola Peserta -->
            <div class="tab-content" id="employee-tab">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-user-edit"></i> Kelola Data Peserta
                    </div>
                    <div class="keterangan">Tambah, edit, atau hapus data peserta</div>
                    
                    <div class="form-group">
                        <label for="admin-name">Nama Peserta:</label>
                        <input type="text" id="admin-name" placeholder="Masukkan nama peserta">
                    </div>
                    <div class="form-group">
                        <label for="admin-password">Password:</label>
                        <input type="password" id="admin-password" placeholder="Masukkan password" value="peserta123">
                    </div>
                    <button id="add-employee-btn"><i class="fas fa-user-plus"></i> Tambah Peserta</button>
                </div>
                
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-users"></i> Daftar Peserta
                    </div>
                    <div class="keterangan">Daftar semua peserta yang terdaftar dalam sistem</div>
                    <table id="employee-list-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama Peserta</th>
                                <th>Password</th>
                                <th>Status Hari Ini</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="employee-list-body">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab Monitoring -->
            <div class="tab-content" id="monitoring-tab">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-chart-bar"></i> Monitoring Real-time
                    </div>
                    <div class="keterangan">Pantau kehadiran peserta secara real-time</div>
                    
                    <div class="attendance-grid" id="monitoring-grid">
                    </div>
                    
                    <div id="monitoring-no-data" style="display: none; text-align: center; padding: 40px; color: #6c757d;">
                        <i class="fas fa-user-times" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <h3>Belum ada peserta yang absen hari ini</h3>
                    </div>
                </div>
            </div>
            
            <!-- Tab QR Code -->
            <div class="tab-content" id="qrcode-tab">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-qrcode"></i> QR Code Akses
                    </div>
                    <div class="keterangan">Gunakan QR Code berikut untuk akses cepat ke aplikasi absensi</div>
                    
                    <div class="access-options">
                        <div class="access-card">
                            <h3><i class="fas fa-sign-in-alt"></i> QR Code Login</h3>
                            <p>Scan untuk langsung ke halaman login</p>
                            <div class="qr-code">
                                <canvas id="admin-login-qr" width="200" height="200"></canvas>
                            </div>
                        </div>
                        
                        <div class="access-card">
                            <h3><i class="fas fa-user-clock"></i> QR Code Absensi</h3>
                            <p>Scan untuk langsung ke halaman absensi peserta</p>
                            <div class="qr-code">
                                <canvas id="admin-attendance-qr" width="200" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Public Display Section -->
        <section id="public-section" class="public-section" style="display: none;">
            <button onclick="showLoginSection()" class="btn-logout"><i class="fas fa-arrow-left"></i> Kembali</button>
            
            <div class="public-display">
                <h1 class="public-title"><i class="fas fa-users"></i> DAFTAR HADIR PESERTA</h1>
                <div class="today-attendance" id="public-today-date"></div>
                
                <div class="stats-box">
                    <div class="stat-card">
                        <div class="stat-number" id="public-total-today">0</div>
                        <div class="stat-label">Hadir Hari Ini</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="public-total-participants">0</div>
                        <div class="stat-label">Total Peserta</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="public-percentage">0%</div>
                        <div class="stat-label">Persentase Kehadiran</div>
                    </div>
                </div>
                
                <h2 style="margin: 30px 0 20px 0; color: #2c3e50;">
                    <i class="fas fa-user-check"></i> Peserta yang Sudah Absen
                </h2>
                
                <div class="attendance-grid" id="public-attendance-grid">
                </div>
                
                <div id="public-no-data" style="display: none; text-align: center; padding: 40px; color: #6c757d;">
                    <i class="fas fa-user-times" style="font-size: 3rem; margin-bottom: 20px;"></i>
                    <h3>Belum ada peserta yang absen hari ini</h3>
                </div>
            </div>
        </section>

        <!-- Publish Instructions Section -->
        <section id="publish-section" class="public-section" style="display: block;">
            <button onclick="showLoginSection()" class="btn-logout"><i class="fas fa-arrow-left"></i> Kembali</button>
            
            <div class="public-display">
                <h1 class="public-title"><i class="fas fa-cloud-upload-alt"></i> Cara Publish Aplikasi</h1>
                
                <div class="publish-section">
                    <h3><i class="fas fa-link"></i> URL Aplikasi Anda:</h3>
                    <div class="url-display">
                        <strong id="current-url">https://run-html-chat.deepseeksvc.com/usercontent/usercontent.html</strong>
                    </div>
                    <button onclick="copyCurrentUrl()" class="btn-export">
                        <i class="fas fa-copy"></i> Salin URL
                    </button>
                </div>

                <div class="publish-steps">
                    <div class="step-card">
                        <div class="step-number">1</div>
                        <h4>Simpan File</h4>
                        <p>Simpan halaman ini sebagai <strong>absensi.html</strong></p>
                        <button onclick="saveFile()" class="btn-export" style="width: 100%; margin-top: 10px;">
                            <i class="fas fa-save"></i> Simpan sebagai HTML
                        </button>
                    </div>
                    
                    <div class="step-card">
                        <div class="step-number">2</div>
                        <h4>Upload ke Hosting</h4>
                        <p>Upload file ke hosting seperti Netlify, Vercel, atau GitHub Pages</p>
                    </div>
                    
                    <div class="step-card">
                        <div class="step-number">3</div>
                        <h4>Share URL</h4>
                        <p>Bagikan URL aplikasi kepada peserta untuk absensi</p>
                    </div>
                    
                    <div class="step-card">
                        <div class="step-number">4</div>
                        <h4>Monitor Absensi</h4>
                        <p>Login sebagai admin untuk memantau kehadiran</p>
                    </div>
                </div>

                <div class="info-box">
                    <h4><i class="fas fa-info-circle"></i> Informasi Penting:</h4>
                    <ul>
                        <li>Data absensi tersimpan di browser masing-masing pengguna</li>
                        <li>Gunakan hosting gratis seperti Netlify untuk publish</li>
                        <li>Aplikasi responsive dan bisa diakses dari HP</li>
                        <li>QR Code bisa digunakan untuk akses cepat</li>
                    </ul>
                </div>
            </div>
        </section>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Database menggunakan localStorage
        const DB_KEYS = {
            EMPLOYEES: 'online_attendance_employees',
            ATTENDANCE: 'online_attendance_records'
        };

        // Daftar peserta default
        const DEFAULT_PARTICIPANTS = [
            "DEDI PAMUNGKAS", "BUDI PURNOMO", "SULARSO", "DHIKI HERMANTO", 
            "MUHAMMAD RICKY SAPUTRA", "INDRA PERMANA", "MUHAMMAD NADIR", 
            "DJALIKA RAJAB", "MOCHAMAD FAISAL AKBAR", "TAJI PANJI PAMUNGKAS",
            "ADAM ALFIANA", "ADE RIDWAN", "AGUNG MUJAYANI SYAH POETRA", 
            "AHMAD HANAFI", "AKHMAD KHADAFI", "AHMAD RONI ALHABSI", "ALFIYANIH",
            "ANDREAS SETIAWAN", "DIAN SUNATRI", "DIKA SAPUTRA", 
            "DIMAS RAMADHANI SHAESARO PUTRA", "DIMAS RUSDI ANGGARA", 
            "DUDI IRAWAN", "DWI PUTRA RIZKY", "FIZA FIKRI QURAISH SURYA",
            "GHANI AHMAD MASUNI", "INDRA MAULANA", "LAUREL KIFLE HELEN",
            "LUSITA ANGRAINI", "LUTFI AHMAD ABIMANYU", "MOHAMMAD DAFFATHUR RAHMAN",
            "MUHAMMAD FEBRIANSYAH", "NICO RONALDO", "NUR MAARIF", "NURSALIM",
            "PANJI TEGUH SUBANGUN", "RAYHAN AKBARUDIN JUNIOR", "RIYANTO",
            "SAHID HAIDIR", "SUKMA PRAYOGA", "M ILHAM SAPUTRA", "NIKI ALAMSYAH",
            "SUGIYANTO", "IQBAL KHOIRUDIN", "PUTRI AYU LESTARI", 
            "ANDIKA PRATAMA NUGROHO", "RAFLI", "FAJAR NUR FIRDAUS"
        ];

        // Struktur data default
        const DEFAULT_DATA = {
            employees: [
                { name: 'admin', password: 'admin123' },
                ...DEFAULT_PARTICIPANTS.map(name => ({ name, password: 'peserta123' }))
            ],
            attendance: []
        };

        // Inisialisasi data
        function initializeData() {
            if (!localStorage.getItem(DB_KEYS.EMPLOYEES)) {
                localStorage.setItem(DB_KEYS.EMPLOYEES, JSON.stringify(DEFAULT_DATA.employees));
            }
            if (!localStorage.getItem(DB_KEYS.ATTENDANCE)) {
                localStorage.setItem(DB_KEYS.ATTENDANCE, JSON.stringify(DEFAULT_DATA.attendance));
            }
            
            populateParticipantDropdown();
            generateQRCodes();
            setupLoginOptions();
            showCurrentUrl();
        }

        // Tampilkan URL saat ini
        function showCurrentUrl() {
            document.getElementById('current-url').textContent = window.location.href;
        }

        // Salin URL
        function copyCurrentUrl() {
            const url = window.location.href;
            navigator.clipboard.writeText(url).then(() => {
                showNotification('login-notification', 'URL berhasil disalin!', 'success');
            });
        }

        // Simpan file
        function saveFile() {
            const htmlContent = document.documentElement.outerHTML;
            const blob = new Blob([htmlContent], { type: 'text/html' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'absensi-online.html';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showNotification('login-notification', 'File berhasil disimpan!', 'success');
        }

        // Tampilkan instruksi publish
        function showPublishInstructions() {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('employee-section').style.display = 'none';
            document.getElementById('admin-section').style.display = 'none';
            document.getElementById('public-section').style.display = 'none';
            document.getElementById('publish-section').style.display = 'block';
        }

        // Setup login options
        function setupLoginOptions() {
            const adminBtn = document.getElementById('admin-login-btn');
            const participantBtn = document.getElementById('participant-login-btn');
            const adminForm = document.getElementById('admin-login-form');
            const participantForm = document.getElementById('participant-login-form');
            const adminInfo = document.getElementById('admin-login-info');
            const participantInfo = document.getElementById('participant-login-info');

            adminBtn.addEventListener('click', function() {
                adminBtn.classList.add('active');
                participantBtn.classList.remove('active');
                adminForm.style.display = 'block';
                participantForm.style.display = 'none';
                adminInfo.style.display = 'block';
                participantInfo.style.display = 'none';
            });

            participantBtn.addEventListener('click', function() {
                participantBtn.classList.add('active');
                adminBtn.classList.remove('active');
                participantForm.style.display = 'block';
                adminForm.style.display = 'none';
                participantInfo.style.display = 'block';
                adminInfo.style.display = 'none';
            });
        }

        // Fungsi untuk mengisi dropdown peserta
        function populateParticipantDropdown() {
            const select = document.getElementById('participant-name');
            select.innerHTML = '<option value="">-- Pilih Nama --</option>';
            
            const employees = getEmployees();
            employees.forEach(employee => {
                if (employee.name !== 'admin') {
                    const option = document.createElement('option');
                    option.value = employee.name;
                    option.textContent = employee.name;
                    select.appendChild(option);
                }
            });
        }

        // Generate QR Codes
        function generateQRCodes() {
            const currentUrl = window.location.href;
            generateQRCode('login-qr-code', currentUrl);
            generateQRCode('admin-login-qr', currentUrl);
            generateQRCode('admin-attendance-qr', currentUrl + '#attendance');
        }

        // Simple QR Code Generator
        function generateQRCode(canvasId, text) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            
            canvas.width = 200;
            canvas.height = 200;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, 200, 200);
            
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(10, 10, 180, 180);
            
            ctx.fillStyle = 'white';
            ctx.fillRect(20, 20, 160, 160);
            
            ctx.fillStyle = '#2c3e50';
            ctx.fillRect(30, 30, 40, 40);
            ctx.fillRect(35, 35, 30, 30);
            ctx.fillRect(130, 30, 40, 40);
            ctx.fillRect(135, 35, 30, 30);
            ctx.fillRect(30, 130, 40, 40);
            ctx.fillRect(35, 135, 30, 30);
            ctx.fillRect(80, 80, 40, 40);
            ctx.fillRect(85, 85, 30, 30);
            
            ctx.fillStyle = '#3498db';
            ctx.font = '12px Arial';
            ctx.fillText('Scan untuk akses', 50, 190);
        }

        // Fungsi untuk mendapatkan data
        function getEmployees() {
            return JSON.parse(localStorage.getItem(DB_KEYS.EMPLOYEES) || '[]');
        }

        function getAttendance() {
            return JSON.parse(localStorage.getItem(DB_KEYS.ATTENDANCE) || '[]');
        }

        // Fungsi untuk menyimpan data
        function saveEmployees(employees) {
            localStorage.setItem(DB_KEYS.EMPLOYEES, JSON.stringify(employees));
        }

        function saveAttendance(attendance) {
            localStorage.setItem(DB_KEYS.ATTENDANCE, JSON.stringify(attendance));
        }

        // Fungsi untuk menampilkan notifikasi
        function showNotification(elementId, message, type) {
            const notification = document.getElementById(elementId);
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 4000);
        }

        // Fungsi untuk mendapatkan waktu saat ini
        function getCurrentDateTime() {
            const now = new Date();
            const date = now.toLocaleDateString('id-ID');
            const time = now.toLocaleTimeString('id-ID');
            return { date, time };
        }

        // Fungsi untuk login - FIXED
        function login() {
            const isAdminLogin = document.getElementById('admin-login-btn').classList.contains('active');
            
            if (isAdminLogin) {
                // Login admin
                const username = document.getElementById('admin-username').value;
                const password = document.getElementById('admin-password').value;
                
                if (!username || !password) {
                    showNotification('login-notification', 'Username dan password harus diisi!', 'error');
                    return false;
                }
                
                if (username === 'admin' && password === 'admin123') {
                    showAdminSection();
                    showNotification('admin-notification', 'Login admin berhasil!', 'success');
                    return true;
                } else {
                    showNotification('login-notification', 'Username atau password admin salah!', 'error');
                    return false;
                }
            } else {
                // Login peserta
                const name = document.getElementById('participant-name').value;
                const password = document.getElementById('participant-password').value;
                
                if (!name || !password) {
                    showNotification('login-notification', 'Pilih nama dan masukkan password!', 'error');
                    return false;
                }
                
                const employees = getEmployees();
                const employee = employees.find(emp => 
                    emp.name === name && emp.password === password
                );
                
                if (employee) {
                    showEmployeeSection(name);
                    showNotification('employee-notification', `Selamat datang, ${name}!`, 'success');
                    return true;
                } else {
                    showNotification('login-notification', 'Nama atau password peserta salah!', 'error');
                    return false;
                }
            }
        }

        // Fungsi untuk menampilkan/menyembunyikan section
        function showLoginSection() {
            document.getElementById('login-section').style.display = 'block';
            document.getElementById('employee-section').style.display = 'none';
            document.getElementById('admin-section').style.display = 'none';
            document.getElementById('public-section').style.display = 'none';
            document.getElementById('publish-section').style.display = 'none';
        }

        function showEmployeeSection(name) {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('employee-section').style.display = 'block';
            document.getElementById('admin-section').style.display = 'none';
            document.getElementById('public-section').style.display = 'none';
            document.getElementById('publish-section').style.display = 'none';
            
            document.getElementById('employee-name-display').value = name;
            loadEmployeeAttendance(name);
        }

        function showAdminSection() {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('employee-section').style.display = 'none';
            document.getElementById('admin-section').style.display = 'block';
            document.getElementById('public-section').style.display = 'none';
            document.getElementById('publish-section').style.display = 'none';
            loadAdminAttendance();
            loadEmployeeList();
            updateStats();
            loadMonitoring();
        }

        function showPublicSection() {
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('employee-section').style.display = 'none';
            document.getElementById('admin-section').style.display = 'none';
            document.getElementById('public-section').style.display = 'block';
            document.getElementById('publish-section').style.display = 'none';
            loadPublicDisplay();
        }

        // Fungsi untuk absensi
        function recordAttendance() {
            const name = document.getElementById('employee-name-display').value;
            
            if (!name) {
                showNotification('employee-notification', 'Tidak ada data peserta!', 'error');
                return false;
            }
            
            const { date, time } = getCurrentDateTime();
            const attendance = getAttendance();
            
            // Cek apakah sudah absen hari ini
            const todayAttendance = attendance.find(record => 
                record.name === name && record.date === date
            );
            
            if (todayAttendance) {
                showNotification('employee-notification', 'Anda sudah absen hari ini!', 'error');
                return false;
            }
            
            // Tambah data absensi baru
            attendance.push({ date, name, time });
            saveAttendance(attendance);
            
            showNotification('employee-notification', 'Absensi berhasil dicatat!', 'success');
            loadEmployeeAttendance(name);
            
            if (document.getElementById('admin-section').style.display === 'block') {
                loadAdminAttendance();
                updateStats();
                loadMonitoring();
            }
            
            return true;
        }

        // Fungsi untuk memuat data absensi peserta
        function loadEmployeeAttendance(name) {
            if (!name) return;
            
            const attendance = getAttendance();
            const employeeAttendance = attendance.filter(record => record.name === name);
            
            const tbody = document.getElementById('employee-attendance-body');
            tbody.innerHTML = '';
            
            if (employeeAttendance.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; color: #6c757d;">
                            <i class="fas fa-info-circle"></i> Belum ada data absensi
                        </td>
                    </tr>
                `;
            } else {
                employeeAttendance.forEach(record => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${record.date}</td>
                        <td>${record.name}</td>
                        <td>${record.time}</td>
                        <td><span style="color: #27ae60; font-weight: bold;"> Hadir</span></td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // Fungsi untuk memuat data absensi admin
        function loadAdminAttendance() {
            const attendance = getAttendance();
            const tbody = document.getElementById('admin-attendance-body');
            tbody.innerHTML = '';
            
            if (attendance.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" style="text-align: center; color: #6c757d;">
                            <i class="fas fa-info-circle"></i> Belum ada data absensi
                        </td>
                    </tr>
                `;
            } else {
                const sortedAttendance = attendance.sort((a, b) => {
                    return new Date(b.date.split('/').reverse().join('-')) - new Date(a.date.split('/').reverse().join('-'));
                });
                
                sortedAttendance.forEach((record, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${record.date}</td>
                        <td>${record.name}</td>
                        <td>${record.time}</td>
                        <td><span style="color: #27ae60; font-weight: bold;"> Hadir</span></td>
                        <td class="action-buttons">
                            <button class="btn-delete" onclick="deleteAttendance(${index})"><i class="fas fa-trash"></i> Hapus</button>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }
        }

        // Fungsi untuk memuat monitoring
        function loadMonitoring() {
            const employees = getEmployees();
            const attendance = getAttendance();
            const today = new Date().toLocaleDateString('id-ID');
            
            const todayAttendance = attendance.filter(record => record.date === today);
            const presentNames = todayAttendance.map(record => record.name);
            
            const grid = document.getElementById('monitoring-grid');
            const noData = document.getElementById('monitoring-no-data');
            
            grid.innerHTML = '';
            
            if (employees.length <= 1) {
                grid.style.display = 'none';
                noData.style.display = 'block';
                return;
            }
            
            grid.style.display = 'grid';
            noData.style.display = 'none';
            
            employees.forEach(employee => {
                if (employee.name === 'admin') return;
                
                const isPresent = presentNames.includes(employee.name);
                const card = document.createElement('div');
                card.className = 'attendance-card';
                card.style.borderLeft = isPresent ? '4px solid #27ae60' : '4px solid #e74c3c';
                
                card.innerHTML = `
                    <div class="attendance-name">${employee.name}</div>
                    <div class="attendance-time" style="color: ${isPresent ? '#27ae60' : '#e74c3c'}; font-weight: bold;">
                        ${isPresent ? ' SUDAH ABSEN' : ' BELUM ABSEN'}
                    </div>
                    ${isPresent ? 
                        `<div style="color: #6c757d; font-size: 0.8rem; margin-top: 5px;">
                            ${todayAttendance.find(r => r.name === employee.name)?.time || ''}
                        </div>` : ''
                    }
                `;
                grid.appendChild(card);
            });
        }

        // Fungsi untuk menghapus absensi
        function deleteAttendance(index) {
            if (confirm('Apakah Anda yakin ingin menghapus data absensi ini?')) {
                const attendance = getAttendance();
                attendance.splice(index, 1);
                saveAttendance(attendance);
                loadAdminAttendance();
                updateStats();
                loadMonitoring();
                showNotification('admin-notification', 'Data absensi berhasil dihapus!', 'success');
            }
        }

        // Fungsi untuk memuat tampilan publik
        function loadPublicDisplay() {
            const attendance = getAttendance();
            const employees = getEmployees();
            const today = new Date().toLocaleDateString('id-ID');
            
            document.getElementById('public-today-date').textContent = `Tanggal: ${today}`;
            
            const todayAttendance = attendance.filter(record => record.date === today);
            const totalParticipants = employees.length - 1;
            const percentage = totalParticipants > 0 ? Math.round((todayAttendance.length / totalParticipants) * 100) : 0;
            
            document.getElementById('public-total-today').textContent = todayAttendance.length;
            document.getElementById('public-total-participants').textContent = totalParticipants;
            document.getElementById('public-percentage').textContent = `${percentage}%`;
            
            const grid = document.getElementById('public-attendance-grid');
            const noData = document.getElementById('public-no-data');
            
            grid.innerHTML = '';
            
            if (todayAttendance.length === 0) {
                grid.style.display = 'none';
                noData.style.display = 'block';
            } else {
                grid.style.display = 'grid';
                noData.style.display = 'none';
                
                todayAttendance.forEach(record => {
                    const card = document.createElement('div');
                    card.className = 'attendance-card';
                    card.innerHTML = `
                        <div class="attendance-name">${record.name}</div>
                        <div class="attendance-time">${record.time}</div>
                    `;
                    grid.appendChild(card);
                });
            }
        }

        // Fungsi untuk update statistik
        function updateStats() {
            const attendance = getAttendance();
            const employees = getEmployees();
            const today = new Date().toLocaleDateString('id-ID');
            
            const totalAttendance = attendance.length;
            const todayAttendance = attendance.filter(record => record.date === today);
            const totalParticipants = employees.length - 1;
            const percentage = totalParticipants > 0 ? Math.round((todayAttendance.length / totalParticipants) * 100) : 0;
            
            document.getElementById('total-attendance').textContent = totalAttendance;
            document.getElementById('today-attendance').textContent = todayAttendance.length;
            document.getElementById('total-participants').textContent = totalParticipants;
            document.getElementById('attendance-percentage').textContent = `${percentage}%`;
            
            // Update status kehadiran
            document.getElementById('present-count').textContent = todayAttendance.length;
            document.getElementById('absent-count').textContent = totalParticipants - todayAttendance.length;
        }

        // Fungsi untuk memuat daftar peserta
        function loadEmployeeList() {
            const employees = getEmployees();
            const attendance = getAttendance();
            const today = new Date().toLocaleDateString('id-ID');
            const todayAttendance = attendance.filter(record => record.date === today);
            
            const tbody = document.getElementById('employee-list-body');
            tbody.innerHTML = '';
            
            let participantCount = 0;
            
            employees.forEach((employee, index) => {
                if (employee.name === 'admin') return;
                
                participantCount++;
                const isPresent = todayAttendance.some(record => record.name === employee.name);
                const status = isPresent ? 
                    '<span style="color: #27ae60; font-weight: bold;"> Hadir</span>' : 
                    '<span style="color: #e74c3c;"> Belum</span>';
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${participantCount}</td>
                    <td>${employee.name}</td>
                    <td>${employee.password}</td>
                    <td>${status}</td>
                    <td class="action-buttons">
                        <button class="btn-delete" onclick="deleteEmployee(${index})"><i class="fas fa-trash"></i> Hapus</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Fungsi untuk menambah peserta
        function addEmployee() {
            const name = document.getElementById('admin-name').value;
            const password = document.getElementById('admin-password').value;
            
            if (!name || !password) {
                showNotification('admin-notification', 'Semua field harus diisi!', 'error');
                return false;
            }
            
            const employees = getEmployees();
            
            if (employees.find(emp => emp.name === name)) {
                showNotification('admin-notification', 'Nama sudah terdaftar!', 'error');
                return false;
            }
            
            employees.push({ name, password });
            saveEmployees(employees);
            
            showNotification('admin-notification', 'Peserta berhasil ditambahkan!', 'success');
            loadEmployeeList();
            updateStats();
            clearEmployeeForm();
            populateParticipantDropdown();
            loadMonitoring();
            return true;
        }

        // Fungsi untuk menghapus peserta
        function deleteEmployee(index) {
            if (confirm('Apakah Anda yakin ingin menghapus peserta ini?')) {
                const employees = getEmployees();
                employees.splice(index, 1);
                saveEmployees(employees);
                loadEmployeeList();
                updateStats();
                populateParticipantDropdown();
                loadMonitoring();
                showNotification('admin-notification', 'Peserta berhasil dihapus!', 'success');
            }
        }

        // Fungsi untuk mengosongkan form peserta
        function clearEmployeeForm() {
            document.getElementById('admin-name').value = '';
            document.getElementById('admin-password').value = 'peserta123';
        }

        // Fungsi untuk export ke Excel
        function exportToExcel() {
            const attendance = getAttendance();
            
            if (attendance.length === 0) {
                showNotification('admin-notification', 'Tidak ada data untuk diexport!', 'error');
                return;
            }
            
            const excelData = attendance.map(record => ({
                'Tanggal': record.date,
                'Nama Peserta': record.name,
                'Jam Masuk': record.time,
                'Status': 'Hadir'
            }));
            
            const ws = XLSX.utils.json_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Data Absensi');
            
            const date = new Date().toISOString().split('T')[0];
            XLSX.writeFile(wb, `data_absensi_${date}.xlsx`);
            
            showNotification('admin-notification', 'Data berhasil diexport ke Excel!', 'success');
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeData();
            showLoginSection();
            
            document.getElementById('login-btn').addEventListener('click', function() {
                login();
            });
            
            document.getElementById('employee-logout').addEventListener('click', function() {
                showLoginSection();
                document.getElementById('employee-name-display').value = '';
            });
            
            document.getElementById('admin-logout').addEventListener('click', function() {
                showLoginSection();
            });
            
            document.getElementById('attendance-btn').addEventListener('click', function() {
                recordAttendance();
            });
            
            document.getElementById('add-employee-btn').addEventListener('click', function() {
                addEmployee();
            });
            
            document.getElementById('export-excel-btn').addEventListener('click', exportToExcel);
            
            document.getElementById('refresh-data-btn').addEventListener('click', function() {
                loadAdminAttendance();
                loadEmployeeList();
                updateStats();
                loadMonitoring();
                showNotification('admin-notification', 'Data berhasil di-refresh!', 'success');
            });
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    this.classList.add('active');
                    const tabId = this.getAttribute('data-tab');
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                    
                    if (tabId === 'monitoring') {
                        loadMonitoring();
                    }
                });
            });
            
            document.getElementById('admin-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('login-btn').click();
                }
            });
            
            document.getElementById('participant-password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('login-btn').click();
                }
            });
        });

        // Global functions
        window.showPublicSection = showPublicSection;
        window.showLoginSection = showLoginSection;
        window.showPublishInstructions = showPublishInstructions;
        window.deleteAttendance = deleteAttendance;
        window.deleteEmployee = deleteEmployee;
        window.copyCurrentUrl = copyCurrentUrl;
        window.saveFile = saveFile;
    </script>

</body></html>